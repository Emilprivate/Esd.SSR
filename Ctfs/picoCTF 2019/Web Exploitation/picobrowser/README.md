# Writeup for picoCTF 2019 : picobrowser

## Tools:
- Web browser with developer tools
- Network tab inspection
- HTTP request modification
- User-Agent header manipulation

## Steps:

### 1. Initial Challenge Analysis
This challenge presented me with a web application that I needed to interact with to obtain the flag. The challenge title "picobrowser" immediately provided a significant hint about the solution approach, suggesting that the application might be checking for a specific browser or user agent.

The title effectively indicated that I would need to understand how web applications identify browsers and potentially manipulate this identification process.

### 2. Initial Interaction and Error Discovery
When I first accessed the web application, I found a "Flag" button that appeared to be the primary interaction point. Upon clicking this button, I was presented with an error message stating that I was not using a "picobrowser."

This error message was crucial because it revealed:
- The application was performing browser detection
- It was specifically looking for a browser called "picobrowser"
- The current browser I was using was not being recognized as the required browser
- I needed to find a way to make my browser appear as a "picobrowser"

### 3. Understanding User-Agent Headers
The error message led me to understand that the application was likely checking the User-Agent header in HTTP requests. The User-Agent header is a standard HTTP header that browsers send to identify themselves to web servers, including information about:

- Browser name and version
- Operating system
- Rendering engine
- Additional browser capabilities

Web applications often use this header to provide browser-specific content or restrict access based on browser type.

### 4. Opening Browser Developer Tools
To modify the User-Agent header, I opened my browser's developer tools, which provide access to network monitoring and request modification capabilities. The developer tools offer several tabs, but I focused on the Network tab because:

- It shows all HTTP requests and responses
- It allows inspection of request headers
- It provides capabilities to modify and resend requests
- It displays server responses in detail

### 5. Analyzing the Initial Request
With the Network tab open, I clicked the Flag button again to capture the HTTP request that was being sent to the server. This allowed me to examine:

- The request URL and method
- All request headers, including the current User-Agent
- The server's response and error message
- The exact format required for successful authentication

### 6. Modifying the User-Agent Header
Using the developer tools' request modification features, I located the User-Agent field in the request headers and changed its value from the default browser identification to `picobrowser`. This modification involved:

- Finding the original User-Agent header in the request
- Replacing its value with the string "picobrowser"
- Ensuring the modification was properly applied to the request

### 7. Resending the Modified Request
After modifying the User-Agent header, I resent the request to the server using the developer tools' resend functionality. This allowed me to:

- Send the same request with the modified User-Agent header
- Observe how the server responded to the new browser identification
- Verify that the application now recognized my browser as a "picobrowser"

### 8. Flag Retrieval and Verification
When I examined the response to the modified request, I found that the server now accepted my browser as a valid "picobrowser" and returned the flag in the response. The successful User-Agent modification demonstrated how web applications can be bypassed when they rely solely on client-side browser identification.

### 9. Learning Outcomes
This challenge effectively demonstrated several important web security concepts:

- **User-Agent spoofing**: How browser identification can be easily manipulated
- **Client-side validation weaknesses**: Why server-side validation should not rely solely on client-provided headers
- **HTTP header manipulation**: Understanding how to modify request headers for testing purposes
- **Browser developer tools usage**: Practical skills for web application testing and debugging

The challenge highlighted that User-Agent headers are easily modifiable and should not be trusted as a security mechanism for access control.

## Flag:
```picoCTF{p1c0_s3cr3t_ag3nt_84f9c865}```
