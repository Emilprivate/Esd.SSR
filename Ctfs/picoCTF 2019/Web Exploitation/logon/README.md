# Writeup for picoCTF 2019 : logon

## Tools:
- Web browser with developer tools
- Cookie inspection and modification
- HTTP request/response analysis
- Authentication bypass techniques

## Steps:

### 1. Initial Challenge Analysis
This challenge presented me with a web application that featured a login system. The challenge title "logon" immediately suggested that I would need to understand and potentially bypass the authentication mechanism to access protected content or retrieve the flag.

The web application provided a login interface where users could enter credentials, indicating that I needed to analyze how the authentication system worked and identify potential vulnerabilities.

### 2. Testing the Login Functionality
When I first accessed the website, I was presented with a login form that requested a username and password. To understand the authentication behavior, I began testing different login scenarios to identify patterns or weaknesses in the system.

My initial testing revealed interesting behavior:
- Attempting to login with various arbitrary usernames (other than "Joe") appeared to succeed without requiring password validation
- The username "Joe" seemed to trigger different behavior, suggesting it might be a special case in the authentication logic
- The system appeared to have inconsistent validation rules

### 3. Identifying Authentication Bypass
Through systematic testing, I discovered a critical flaw in the authentication system: any username except "Joe" could successfully log in without proper password verification. This represented a significant authentication bypass vulnerability where the system failed to properly validate credentials for most users.

This discovery indicated that:
- The authentication logic had a specific exception for the user "Joe"
- All other usernames bypassed normal password validation
- The system likely relied on client-side mechanisms for access control

### 4. Analyzing Client-Side Authentication Mechanisms
After successfully logging in with an arbitrary username, I opened the browser's developer tools to examine how the application managed user sessions and authorization. My focus was on understanding what client-side data the application used to determine user privileges.

### 5. Cookie Inspection and Discovery
Using the developer tools, I navigated to the cookie storage section to examine what data the application had stored in my browser after the successful login. This analysis revealed the presence of an "admin" cookie that appeared to control administrative access levels.

The cookie inspection showed:
- An "admin" cookie was created during the login process
- The cookie's value appeared to determine authorization levels
- The cookie was likely used by the application to check user privileges

### 6. Understanding Cookie-Based Authorization
The discovery of the "admin" cookie revealed that the application was using client-side cookie values to determine user authorization levels. This approach represents a significant security vulnerability because:

- Client-side data can be easily modified by users
- Cookie values should not be trusted for security decisions
- Authorization checks should be performed server-side

### 7. Cookie Manipulation and Privilege Escalation
With the "admin" cookie identified, I proceeded to modify its value to escalate my privileges. Using the developer tools' cookie editing functionality, I changed the "admin" cookie value to "true" to indicate administrative access.

The modification process involved:
- Locating the "admin" cookie in the developer tools
- Changing its value from the default to "true"
- Ensuring the modification was properly applied

### 8. Flag Retrieval Through Privilege Escalation
After modifying the "admin" cookie value to "true", I refreshed the website to allow the application to recognize my elevated privileges. The application accepted the modified cookie value and granted administrative access, revealing the flag.

### 9. Learning Outcomes
This challenge effectively demonstrated several important web security concepts:

- **Client-side authentication weaknesses**: How relying on client-side data for authorization creates vulnerabilities
- **Cookie manipulation**: The ease with which client-side cookies can be modified
- **Authentication bypass techniques**: Methods for circumventing flawed login systems
- **Privilege escalation**: How to exploit authorization flaws to gain elevated access

The challenge highlighted the critical importance of implementing proper server-side authentication and authorization mechanisms rather than relying on client-side controls.

## Flag:
```picoCTF{th3_c0nsp1r4cy_l1v3s_0c98aacc}```
